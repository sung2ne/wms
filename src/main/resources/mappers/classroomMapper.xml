<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="classroom">

	<resultMap id="classroom" type="wms.domain.ClassroomVo">
		<!-- 교수별 교과목 -->
		<result property="classroomIdx" 		column="CLASSROOM_IDX" />		<!-- 교수별 교과목 IDX -->
		<result property="professorIdx"			column="PROFESSOR_IDX" />		<!-- 교수 IDX -->
		<result property="professorName"		column="PROFESSOR_NAME" />		<!-- 교수 이름 -->
		<result property="classroom"			column="CLASSROOM" />			<!-- 분반 -->
		<!-- 대학 -->
		<result property="collegeIdx" 			column="COLLEGE_IDX" />			<!-- 대학 IDX -->
		<result property="collegeName" 			column="COLLEGE_NAME" />		<!-- 대학 이름 -->
		<!-- 학과 -->
		<result property="departmentIdx" 		column="DEPARTMENT_IDX" />		<!-- 학과 IDX -->
		<result property="departmentName"	 	column="DEPARTMENT_NAME" />		<!-- 학과 이름 -->
		<!-- 년도/학기 -->
		<result property="yearSemesterIdx" 		column="YEAR_SEMESTER_IDX" />	<!-- 년도/학기 IDX -->
		<result property="year" 				column="YEAR" />				<!-- 년도 -->
		<result property="semester"	 			column="SEMESTER" />			<!-- 학기 -->
		<result property="startDateTime"	 	column="START_DATETIME" />		<!-- 시작 일시 -->
		<result property="endDateTime"		 	column="END_DATETIME" />		<!-- 종료 일시 -->
		<!-- 교과목 -->
		<result property="subjectIdx" 			column="SUBJECT_IDX" />			<!-- 교과목 IDX -->
		<result property="subjectName" 			column="SUBJECT_NAME" />		<!-- 교과목 이름 -->
		<!-- 등록, 수정, 삭제 -->
		<result property="useYN" 				column="USE_YN" />				<!-- 사용여부, Y:사용, N:사용안함 -->
		<result property="deleteYN" 			column="DELETE_YN" />			<!-- 삭제여부, Y:삭제, N:삭제안함 -->
		<result property="createUserIdx" 		column="CREATE_USER_IDX" />		<!-- 생생한 사용자 IDX -->
		<result property="updateUserIdx" 		column="UPDATE_USER_IDX" />		<!-- 수정한 사용자 IDX -->
		<result property="deleteUserIdx" 		column="DELETE_USER_IDX" />		<!-- 삭제한 사용자 IDX -->
		<result property="createUserName" 		column="CREATE_USER_NAME" />	<!-- 생생한 사용자 이름 -->
		<result property="updateUserName" 		column="UPDATE_USER_NAME" />	<!-- 수정한 사용자 이름 -->
		<result property="deleteUserName" 		column="DELETE_USER_NAME" />	<!-- 삭제한 사용자 이름 -->
		<result property="createDateTime"	 	column="CREATE_DATETIME" />		<!-- 생성한 일시 -->
		<result property="updateDateTime"	 	column="UPDATE_DATETIME" />		<!-- 수정한 일시 -->
		<result property="deleteDateTime"	 	column="DELETE_DATETIME" />		<!-- 삭제한 일시 -->
	</resultMap>

	<!-- 추가 -->
	<insert id="create">
		<![CDATA[
		INSERT INTO TB_CLASSROOM (
			CLASSROOM_IDX
			, COLLEGE_IDX
			, DEPARTMENT_IDX
			, YEAR_SEMESTER_IDX
			, SUBJECT_IDX
			, PROFESSOR_IDX
			, CLASSROOM
			, USE_YN, DELETE_YN, CREATE_USER_IDX, CREATE_DATETIME
		) VALUES (
			#{classroomIdx}
			, #{collegeIdx}
			, #{departmentIdx}
			, #{yearSemesterIdx}
			, #{subjectIdx}
			, #{professorIdx}
			, #{classroom}
			, #{useYN}, #{deleteYN}, #{createUserIdx}, #{createDateTime}
		)
		]]>
	</insert>

	<!-- 보기 -->
	<select id="read" resultMap="classroom">
		<![CDATA[
		SELECT
			T_CLASSROOM.CLASSROOM_IDX
			, T_CLASSROOM.COLLEGE_IDX
			, T_CLASSROOM.DEPARTMENT_IDX
			, T_CLASSROOM.YEAR_SEMESTER_IDX
			, T_CLASSROOM.SUBJECT_IDX
			, T_CLASSROOM.PROFESSOR_IDX
			, T_CLASSROOM.CLASSROOM
			, T_CLASSROOM.USE_YN
			, T_CLASSROOM.DELETE_YN
			, T_CLASSROOM.CREATE_USER_IDX
			, T_CLASSROOM.UPDATE_USER_IDX
			, T_CLASSROOM.DELETE_USER_IDX
			, T_CLASSROOM.UPDATE_DATETIME
			, T_CLASSROOM.CREATE_DATETIME
			, T_CLASSROOM.DELETE_DATETIME
			, T_USER_CREATE.USER_NAME AS CREATE_USER_NAME
			, T_USER_UPDATE.USER_NAME AS UPDATE_USER_NAME
			, T_USER_DELETE.USER_NAME AS DELETE_USER_NAME
			, T_COLLEGE.COLLEGE_NAME
			, T_DEPARTMENT.DEPARTMENT_NAME
			, T_YEAR_SEMESTER.YEAR
			, T_YEAR_SEMESTER.SEMESTER
			, T_YEAR_SEMESTER.START_DATETIME
			, T_YEAR_SEMESTER.END_DATETIME
			, T_SUBJECT.SUBJECT_NAME
			, T_PROFESSOR.USER_NAME AS PROFESSOR_NAME
		FROM TB_CLASSROOM AS T_CLASSROOM
		LEFT JOIN TB_COLLEGE AS T_COLLEGE ON T_COLLEGE.COLLEGE_IDX = T_CLASSROOM.COLLEGE_IDX
		LEFT JOIN TB_DEPARTMENT AS T_DEPARTMENT ON T_DEPARTMENT.DEPARTMENT_IDX = T_CLASSROOM.DEPARTMENT_IDX
		LEFT JOIN TB_SUBJECT AS T_SUBJECT ON T_SUBJECT.SUBJECT_IDX = T_CLASSROOM.SUBJECT_IDX
		LEFT JOIN TB_YEAR_SEMESTER AS T_YEAR_SEMESTER ON T_YEAR_SEMESTER.YEAR_SEMESTER_IDX = T_CLASSROOM.YEAR_SEMESTER_IDX
		LEFT JOIN TB_USER AS T_PROFESSOR ON T_PROFESSOR.USER_IDX = T_CLASSROOM.PROFESSOR_IDX
		LEFT JOIN TB_USER AS T_USER_CREATE ON T_USER_CREATE.USER_IDX = T_CLASSROOM.CREATE_USER_IDX
		LEFT JOIN TB_USER AS T_USER_UPDATE ON T_USER_UPDATE.USER_IDX = T_CLASSROOM.UPDATE_USER_IDX
		LEFT JOIN TB_USER AS T_USER_DELETE ON T_USER_DELETE.USER_IDX = T_CLASSROOM.DELETE_USER_IDX
		WHERE T_CLASSROOM.CLASSROOM_IDX = #{classroomIdx}
		LIMIT 1
		]]>
	</select>

	<!-- 수정 -->
	<select id="update">
		<![CDATA[
		UPDATE TB_CLASSROOM SET CLASSROOM_IDX = #{classroomIdx}
		]]>
		<if test="collegeIdx != null">
			, COLLEGE_IDX = #{collegeIdx}
		</if>
		<if test="departmentIdx != null">
			, DEPARTMENT_IDX = #{departmentIdx}
		</if>
		<if test="yearSemesterIdx != null">
			, YEAR_SEMESTER_IDX = #{yearSemesterIdx}
		</if>
		<if test="subjectIdx != null">
			, SUBJECT_IDX = #{subjectIdx}
		</if>
		<if test="professorIdx != null">
			, PROFESSOR_IDX = #{professorIdx}
		</if>
		<if test="classroom != null">
			, CLASSROOM = #{classroom}
		</if>
		<if test="useYN != null">
			, USE_YN = #{useYN}
		</if>
		<if test="updateUserIdx != null">
			, UPDATE_USER_IDX = #{updateUserIdx}, UPDATE_DATETIME = #{updateDateTime}
		</if>
		<choose>
			<when test="deleteYN != null and deleteYN == 'Y'.toString()">
				, DELETE_YN = #{deleteYN}, DELETE_USER_IDX = #{deleteUserIdx}, DELETE_DATETIME = #{deleteDateTime}
			</when>
			<when test="deleteYN != null and deleteYN == 'N'.toString()">
				, DELETE_YN = #{deleteYN}, DELETE_USER_IDX = "", DELETE_DATETIME = ""
			</when>
		</choose>
		WHERE CLASSROOM_IDX = #{classroomIdx}
	</select>

	<!-- 목록 -->
	<select id="all" resultMap="classroom">
		<![CDATA[
		SELECT
			T_CLASSROOM.CLASSROOM_IDX
			, T_CLASSROOM.COLLEGE_IDX
			, T_CLASSROOM.DEPARTMENT_IDX
			, T_CLASSROOM.YEAR_SEMESTER_IDX
			, T_CLASSROOM.SUBJECT_IDX
			, T_CLASSROOM.PROFESSOR_IDX
			, T_CLASSROOM.CLASSROOM
			, T_CLASSROOM.USE_YN
			, T_CLASSROOM.DELETE_YN
			, T_CLASSROOM.CREATE_USER_IDX
			, T_CLASSROOM.UPDATE_USER_IDX
			, T_CLASSROOM.DELETE_USER_IDX
			, T_CLASSROOM.UPDATE_DATETIME
			, T_CLASSROOM.CREATE_DATETIME
			, T_CLASSROOM.DELETE_DATETIME
			, T_USER_CREATE.USER_NAME AS CREATE_USER_NAME
			, T_USER_UPDATE.USER_NAME AS UPDATE_USER_NAME
			, T_USER_DELETE.USER_NAME AS DELETE_USER_NAME
			, T_COLLEGE.COLLEGE_NAME
			, T_DEPARTMENT.DEPARTMENT_NAME
			, T_YEAR_SEMESTER.YEAR
			, T_YEAR_SEMESTER.SEMESTER
			, T_YEAR_SEMESTER.START_DATETIME
			, T_YEAR_SEMESTER.END_DATETIME
			, T_SUBJECT.SUBJECT_NAME
			, T_PROFESSOR.USER_NAME AS PROFESSOR_NAME
		FROM TB_CLASSROOM AS T_CLASSROOM
		LEFT JOIN TB_COLLEGE AS T_COLLEGE ON T_COLLEGE.COLLEGE_IDX = T_CLASSROOM.COLLEGE_IDX
		LEFT JOIN TB_DEPARTMENT AS T_DEPARTMENT ON T_DEPARTMENT.DEPARTMENT_IDX = T_CLASSROOM.DEPARTMENT_IDX
		LEFT JOIN TB_SUBJECT AS T_SUBJECT ON T_SUBJECT.SUBJECT_IDX = T_CLASSROOM.SUBJECT_IDX
		LEFT JOIN TB_YEAR_SEMESTER AS T_YEAR_SEMESTER ON T_YEAR_SEMESTER.YEAR_SEMESTER_IDX = T_CLASSROOM.YEAR_SEMESTER_IDX
		LEFT JOIN TB_USER AS T_PROFESSOR ON T_PROFESSOR.USER_IDX = T_CLASSROOM.PROFESSOR_IDX
		LEFT JOIN TB_USER AS T_USER_CREATE ON T_USER_CREATE.USER_IDX = T_CLASSROOM.CREATE_USER_IDX
		LEFT JOIN TB_USER AS T_USER_UPDATE ON T_USER_UPDATE.USER_IDX = T_CLASSROOM.UPDATE_USER_IDX
		LEFT JOIN TB_USER AS T_USER_DELETE ON T_USER_DELETE.USER_IDX = T_CLASSROOM.DELETE_USER_IDX
		WHERE 1=1
		]]>
		<if test="useYN != null">
			AND T_CLASSROOM.USE_YN = #{useYN}
		</if>
		<if test="deleteYN != null">
			AND T_CLASSROOM.DELETE_YN = #{deleteYN}
		</if>
		ORDER BY T_CLASSROOM.CLASSROOM DESC
	</select>

</mapper>
